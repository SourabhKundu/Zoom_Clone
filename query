SELECT
    consl.consl_sk,
    CASE
        WHEN NVL(consl.consl_xref_id, 'E') = 'E' THEN consl.consl_desc
        ELSE consl.consl_xref_id || ' - ' || consl.consl_desc
    END AS decode,
    consl.cust_sk,
    consl.consl_upd_user_sk
FROM npf_consl consl
JOIN npf_consl_cmpnt cmpnt
    ON consl.consl_sk = cmpnt.consl_sk
WHERE consl.cust_sk = 123456
  AND consl.consl_stat_dcde = 'ACTIVE'
  AND cmpnt.cmpnt_sk_val = COALESCE(
      (
        SELECT cmpnt_ac_sk
        FROM npf_decoder_xref
        WHERE decoder_ac_sk = 78910
          AND cust_sk = 123456
        ORDER BY cmpnt_data_src_id ASC
        LIMIT 1
      ),
      78910
  )
  AND cmpnt.cmpnt_dcde = 'ABC123'
  AND cmpnt.consl_cmpnt_stat_dcde = 'ACTIVE'
ORDER BY decode;
